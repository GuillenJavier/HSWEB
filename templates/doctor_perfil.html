{% extends "_layout.html" %}
{% block title %}Perfil del médico{% endblock %}
{% block content %}

<h2>Perfil del Dr. {{ medico.usuario.nombre }} {{ medico.usuario.apellido }} — {{ medico.especialidad }}</h2>

<section>
  <h3>Próximas citas</h3>
  {% if citas|length == 0 %}
    <p>No hay citas próximas para este médico.</p>
  {% else %}
    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Paciente</th>
          <th>Inicio</th>
          <th>Fin</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for c in citas %}
        <tr>
          <td>{{ c.id }}</td>
          <td>{{ c.paciente.nombre }} {{ c.paciente.apellido }}</td>
          <td>{{ c.start_at }}</td>
          <td>{{ c.end_at }}</td>
          <td>{{ c.estado }}</td>
          <td>
            <a href="{{ url_for('citas_edit', cita_id=c.id) }}">Editar cita</a>
            · <a href="{{ url_for('expediente_view', paciente_id=c.paciente.id) }}">Ver expediente</a>
            {% if puede_editar_expediente %}
              · <a href="{{ url_for('expediente_edit', paciente_id=c.paciente.id) }}">Editar expediente</a>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
</section>

<hr>

<section>
  <h3>Pacientes atendidos</h3>
  {% if pacientes|length == 0 %}
    <p>Aún no hay pacientes registrados para este médico.</p>
  {% else %}
    <ul>
      {% for p in pacientes %}
        <li>
          <strong>{{ p.nombre }} {{ p.apellido }}</strong>
          · <a href="{{ url_for('doctor_consultas', paciente_id=p.id) }}">Ver citas pendientes</a>
          · <a href="{{ url_for('expediente_view', paciente_id=p.id) }}">Ver expediente</a>
          {% if puede_editar_expediente %}
            · <a href="{{ url_for('expediente_edit', paciente_id=p.id) }}">Editar expediente</a>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% endif %}
</section>

{% endblock %}
